<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>EarnHub - Make Money Online</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <script type='text/javascript' src='//viaanswerwillow.com/c2/2f/5a/c22f5a51bee05171649c6b1194870f89.js'></script>
    
    <style>
        :root {
            --bg-color: #0c0e1b;
            --card-color: #1a1e36;
            --text-color: #e0e6f6;
            --secondary-text-color: #9299b8;
            --accent-color: #4CAF50;
            --accent-dark: #3e8e41;
            --button-color: linear-gradient(45deg, #4CAF50, #66bb6a);
            --button-shadow: 0 4px 15px rgba(0, 200, 83, 0.4);
            --border-color: #343b59;
            --error-color: #f44336;
            --success-color: #4CAF50;
            --info-color: #2196F3;
            --gradient-1: linear-gradient(135deg, #2c3e50, #34495e);
            --gradient-2: linear-gradient(135deg, #34495e, #2c3e50);
            --telegram-color: #0088cc;
        }

        * {
            box-sizing: border-box;
            transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }

        body {
            font-family: 'Poppins', sans-serif;
            margin: 0;
            padding: 0;
            background: var(--bg-color);
            color: var(--text-color);
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            line-height: 1.6;
        }

        .container {
            max-width: 500px;
            width: 100%;
            margin: auto;
            padding: 20px;
            box-sizing: border-box;
            text-align: center;
            flex-grow: 1;
            padding-bottom: 80px;
        }

        .header {
            text-align: center;
            margin-bottom: 25px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        .header .back-btn {
            position: absolute;
            left: 0;
            font-size: 1.5em;
            color: var(--secondary-text-color);
            cursor: pointer;
            padding: 5px;
            border-radius: 50%;
        }

        .header .back-btn:hover {
            color: var(--accent-color);
        }

        h2, h3, h4 {
            color: var(--text-color);
            margin: 0;
            flex-grow: 1;
            font-weight: 600;
        }

        h2 {
            font-size: 1.5em;
        }

        .card {
            background: var(--card-color);
            padding: 25px;
            border-radius: 16px;
            margin-bottom: 25px;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.3);
            border: 1px solid var(--border-color);
        }
        
        .balance-card {
            display: flex;
            align-items: center;
            justify-content: space-between;
            border-left: 4px solid var(--accent-color);
        }

        .balance-info {
            text-align: left;
        }

        .balance-text {
            font-size: 0.9em;
            color: var(--secondary-text-color);
            margin: 0;
        }

        .balance-value {
            font-size: 2em;
            font-weight: bold;
            color: var(--accent-color);
            margin: 5px 0 0 0;
            letter-spacing: 1px;
        }

        .balance-icon {
            font-size: 3em;
            color: var(--border-color);
            opacity: 0.5;
        }

        .button {
            display: block;
            width: 100%;
            padding: 18px;
            margin-bottom: 25px;
            background: var(--button-color);
            color: var(--text-color);
            text-decoration: none;
            border-radius: 12px;
            font-size: 1.1em;
            font-weight: bold;
            cursor: pointer;
            border: none;
            box-shadow: var(--button-shadow);
        }

        .button:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(0, 200, 83, 0.6);
        }

        .button:active {
            transform: scale(0.98);
        }

        .button.secondary {
            background: var(--gradient-1);
            color: var(--text-color);
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
        }

        .button.secondary:hover {
            background: var(--gradient-2);
        }
        
        .telegram-link-button {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 100%;
            padding: 15px;
            margin-bottom: 25px;
            background: var(--telegram-color);
            color: #fff;
            text-decoration: none;
            border-radius: 10px;
            font-size: 1.1em;
            font-weight: bold;
            cursor: pointer;
            border: none;
            box-shadow: 0 4px 10px rgba(0, 136, 204, 0.3);
        }
        .telegram-link-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 136, 204, 0.5);
        }
        .telegram-link-button i {
            margin-right: 10px;
            font-size: 1.2em;
        }

        .lottery-button {
            background: linear-gradient(45deg, #FF5722, #FF9800);
            box-shadow: 0 4px 15px rgba(255, 87, 34, 0.4);
        }

        .lottery-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(255, 87, 34, 0.6);
        }
        
        .nav-bar {
            background: #121528;
            border-top: 1px solid var(--border-color);
            display: flex;
            justify-content: space-around;
            padding: 15px 0;
            position: fixed;
            bottom: 0;
            width: 100%;
            max-width: 500px;
            margin: 0 auto;
            box-shadow: 0 -8px 20px rgba(0, 0, 0, 0.3);
            border-radius: 20px 20px 0 0;
            z-index: 100;
        }

        .nav-item {
            text-align: center;
            color: var(--secondary-text-color);
            font-size: 0.8em;
            text-decoration: none;
            cursor: pointer;
            padding: 5px 10px;
            border-radius: 10px;
        }

        .nav-item i {
            font-size: 1.5em;
            margin-bottom: 5px;
            display: block;
        }

        .nav-item.active {
            color: var(--accent-color);
            font-weight: bold;
            background: rgba(76, 175, 80, 0.1);
        }

        .nav-item:hover {
            color: var(--accent-color);
        }

        .content-section {
            display: none;
            animation: fadeIn 0.6s ease-in-out;
        }

        .content-section.active {
            display: block;
        }
        
        .list-item, .task-list-item {
            display: flex;
            align-items: center;
            gap: 15px;
            cursor: pointer;
            background-color: #1a1e36;
            padding: 18px;
            margin-bottom: 15px;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            text-align: left;
            border-left: 3px solid transparent;
        }

        .list-item:hover, .task-list-item:hover {
            border-left: 3px solid var(--accent-color);
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
        }

        .list-item i {
            font-size: 1.5em;
            color: var(--accent-color);
        }
        
        .task-list-item .task-icon {
            font-size: 1.5em;
        }
        .task-list-item .ad-icon { color: var(--accent-color); }
        .task-list-item .survey-icon { color: #f39c12; }
        .task-list-item .website-icon { color: #3498db; }
        .task-list-item .captcha-icon { color: #9b59b6; }
        .task-list-item .facebook-icon { color: #1877F2; }
        .task-list-item .instagram-icon { color: #E1306C; }

        .task-list-item .task-info h4 {
            font-weight: 600;
        }
        .task-list-item .task-info p {
            color: var(--secondary-text-color);
            font-size: 0.9em;
            margin: 0;
        }

        .input-group {
            text-align: left;
            margin-bottom: 20px;
        }

        .input-group label {
            display: block;
            margin-bottom: 8px;
            color: var(--secondary-text-color);
            font-size: 0.9em;
            font-weight: 500;
        }

        .input-group input, .input-group select {
            width: 100%;
            padding: 14px;
            border-radius: 10px;
            border: 1px solid var(--border-color);
            background-color: #121528;
            color: var(--text-color);
            font-size: 1em;
            box-sizing: border-box;
        }

        .input-group input:focus, .input-group select:focus {
            outline: none;
            border-color: var(--accent-color);
            box-shadow: 0 0 0 3px rgba(76, 175, 80, 0.2);
        }

        .alert-box {
            padding: 15px;
            border-radius: 10px;
            margin-top: 20px;
            margin-bottom: 20px;
            text-align: left;
            border-left: 4px solid;
            background: rgba(0, 0, 0, 0.1);
        }
        
        .alert-box.success {
            border-color: var(--success-color);
            background-color: rgba(76, 175, 80, 0.1);
        }
        .alert-box.error {
            border-color: var(--error-color);
            background-color: rgba(244, 67, 54, 0.1);
        }
        .alert-box.info {
            border-color: var(--info-color);
            background-color: rgba(33, 150, 243, 0.1);
        }
        
        .alert-box h4 {
            color: var(--info-color);
            margin: 0 0 5px 0;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .alert-box.success h4 { color: var(--success-color); }
        .alert-box.error h4 { color: var(--error-color); }

        .alert-box p {
            font-size: 0.9em;
            color: var(--secondary-text-color);
            margin: 0;
        }
        
        .section-title {
            margin-bottom: 20px;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .profile-info-item {
            text-align: left;
            margin-bottom: 15px;
        }
        .profile-info-item label {
            display: block;
            font-weight: 500;
            color: var(--secondary-text-color);
            margin-bottom: 5px;
        }
        .profile-info-item span {
            display: block;
            font-size: 1.1em;
            color: var(--text-color);
        }

        .earnings-history-list li {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid var(--border-color);
        }
        .earnings-history-list li:last-child {
            border-bottom: none;
        }
        .earning-item {
            font-weight: 500;
            color: var(--text-color);
        }
        .earning-value {
            font-weight: 600;
            color: var(--accent-color);
        }
        
        .list-item.lottery-item i {
            color: #FF5722;
        }
        .list-item.mail-item i {
            color: #FF69B4;
        }
        .task-list-item.direct-link-item .task-icon {
            color: #2196F3;
        }

        .lottery-winner-card {
            background-color: #21253d;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 25px;
            text-align: center;
            border: 1px solid #444a69;
        }
        .lottery-winner-card h4 {
            color: #FF9800;
            margin-bottom: 10px;
        }
        .lottery-winner-card .winner-number {
            font-size: 2.2em;
            font-weight: bold;
            color: #f39c12;
            letter-spacing: 2px;
        }
        .lottery-winner-card p {
            color: var(--secondary-text-color);
            margin-top: 5px;
            font-size: 0.9em;
        }

        .my-tickets-card h4 {
            margin-bottom: 10px;
        }

    </style>
</head>
<body>

    <div id="registration-screen" style="display: none;">
        <div class="card">
            <h3>Complete Your Profile <i class="fas fa-user-edit"></i></h3>
            
            <div class="input-group">
                <label for="reg-username">Username</label>
                <input type="text" id="reg-username" placeholder="Enter your username">
            </div>
            
            <div class="input-group">
                <label for="reg-nickname">Nickname</label>
                <input type="text" id="reg-nickname" placeholder="What should we call you?">
            </div>
            
            <div class="input-group">
                <label for="reg-phone">Phone Number</label>
                <input type="tel" id="reg-phone" placeholder="11-digit number (e.g. 01712345678)" maxlength="11">
            </div>
            
            <div class="input-group">
                <label for="reg-password">Transaction Password</label>
                <input type="password" id="reg-password" placeholder="6-digit password" maxlength="6">
                <p style="text-align: left; font-size: 0.8em; color: var(--secondary-text-color); margin-top: 5px;">
                    This password will be used for withdrawals and sensitive actions.
                </p>
            </div>
            
            <button class="button" onclick="showActivationForm()">
                <i class="fas fa-user-plus"></i> Register Now
            </button>
            
            <p style="color: var(--secondary-text-color); font-size: 0.8em; margin-top: 15px;">
                By registering, you agree to our <a href="#" style="color: var(--accent-color);" onclick="showSection('privacy-policy-page')">Privacy Policy</a>
            </p>
        </div>
    </div>
    
    <div id="activation-screen" style="display: none;">
        <div class="card">
            <h3>Account Activation <i class="fas fa-unlock"></i></h3>
            
            <div class="alert-box info">
                <h4><i class="fas fa-info-circle"></i> Important Notice</h4>
                <p>
                    আপনার একাউন্ট অ্যাক্টিভ করার জন্য নিচে দেওয়া নম্বরে অনলি ২৫ টাকা সেন্ড মানি করুন।
                </p>
                <p style="font-weight: bold; color: var(--text-color); margin-top: 10px;">
                    <i class="fas fa-mobile-alt"></i> **পেমেন্ট নম্বর (Send Money):** <span style="font-weight: bold; color: var(--accent-color);">০১৭৪৮৪৮৭৪৮৪</span>
                </p>
            </div>

            <div class="input-group">
                <label for="transaction-id">Transaction ID (TrxID)</label>
                <input type="text" id="transaction-id" placeholder="Enter TrxID">
            </div>
            
            <div class="input-group">
                <label for="sender-number">Your Phone Number</label>
                <input type="tel" id="sender-number" placeholder="Enter your number">
            </div>
            
            <button class="button" onclick="submitActivation()">
                <i class="fas fa-paper-plane"></i> Send Request
            </button>
        </div>
    </div>

    <div id="main-app" style="display: none;">
        <div class="container">
            
            <div id="home" class="content-section active">
                <div class="header">
                    <h2>Welcome, <span id="welcome-nickname"></span> <i class="fas fa-hand-sparkles"></i></h2>
                </div>
                
                <script type="text/javascript">
                atOptions = {
                'key' : '3e8de08585fbff771f13f27096f68fa0',
                'format' : 'iframe',
                'height' : 50,
                'width' : 320,
                'params' : {}
                };
                </script>
                <script type="text/javascript" src="//viaanswerwillow.com/3e8de08585fbff771f13f27096f68fa0/invoke.js"></script>

                <div class="card balance-card">
                    <div class="balance-info">
                        <p class="balance-text">Your Current Balance</p>
                        <h1 class="balance-value" id="balanceDisplay">0 BDT</h1>
                    </div>
                    <i class="fas fa-wallet balance-icon"></i>
                </div>
                
                <div class="card lottery-winner-card">
                    <h4><i class="fas fa-trophy"></i> আগেরবারের বিজয়ী</h4>
                    <span class="winner-number" id="previousWinnerNumber">-------</span>
                    <p style="margin-top: 10px;">
                        লটারির ড্র হয় প্রতি শুক্রবার
                    </p>
                </div>
                
                <a id="telegram-link" class="telegram-link-button" href="https://t.me/your_telegram_channel" target="_blank">
                    <i class="fab fa-telegram-plane"></i> Join Our Telegram Channel
                </a>

                <button class="button" id="dailyCheckinButton" onclick="dailyCheckin()">
                    <i class="fas fa-calendar-check"></i> Daily Check-in
                </button>

                <script async="async" data-cfasync="false" src="//viaanswerwillow.com/3209e68579e4f1bf631f417096bd186e/invoke.js"></script>
                <div id="container-3209e68579e4f1bf631f417096bd186e"></div>
            </div>

            <div id="mail-page" class="content-section">
                <div class="header">
                    <i class="fas fa-arrow-left back-btn" onclick="showSection('settings')"></i>
                    <h2><i class="fas fa-envelope-open-text"></i> ইনবক্স</h2>
                </div>
                <div class="card">
                    <h3 class="section-title">
                        আপনার মেসেজগুলো
                    </h3>
                    <ul id="mailList" class="mail-list">
                        <li class="mail-item">
                            <h4>নতুন আপডেট!</h4>
                            <p>প্রিয় ইউজার, আমাদের অ্যাপে কিছু নতুন ফিচার যুক্ত করা হয়েছে।</p>
                        </li>
                        <li class="mail-item">
                            <h4>আপনার উইথড্রয়াল রিকোয়েস্ট</h4>
                            <p>আপনার উইথড্রয়াল রিকোয়েস্ট সফলভাবে প্রসেস করা হয়েছে।</p>
                        </li>
                        <li class="mail-item">
                            <h4>গুরুত্বপূর্ণ ঘোষণা</h4>
                            <p>অনুগ্রহ করে আপনার ট্রানজেকশন পাসওয়ার্ডটি কারো সাথে শেয়ার করবেন না।</p>
                        </li>
                    </ul>
                </div>
            </div>

            <div id="lottery-page" class="content-section">
                <div class="header">
                    <i class="fas fa-arrow-left back-btn" onclick="showSection('tasks')"></i>
                    <h2><i class="fas fa-ticket-alt"></i> লটারি</h2>
                </div>
                
                <div class="card my-tickets-card">
                    <h3 class="section-title">
                        <i class="fas fa-receipt"></i> আপনার টিকিটগুলো
                    </h3>
                    <ul id="userTicketsList" style="list-style-type: none; padding: 0;">
                        <li style="color: var(--secondary-text-color);">
                            আপনার কেনা টিকিট এখানে দেখা যাবে।
                        </li>
                    </ul>
                </div>

                <div class="card">
                    <h3 class="section-title">
                        <i class="fas fa-sack-dollar"></i> টিকিট কিনুন
                    </h3>
                    <p style="color: var(--secondary-text-color); margin-top: -15px;">
                        প্রতিটি টিকিট: 10 BDT
                    </p>
                    <button class="button lottery-button" onclick="buyLotteryTicket()">
                        <i class="fas fa-ticket-alt"></i> লটারি টিকিট কিনুন
                    </button>
                </div>
                
                <div class="alert-box info">
                    <h4><i class="fas fa-info-circle"></i> গুরুত্বপূর্ণ তথ্য</h4>
                    <p>
                        শুক্রবার লটারির বিজয়ী ঘোষণা করা হবে। আপনার টিকিট নাম্বারটি মিলে গেলে আপনি 1000 BDT পুরস্কার পাবেন।
                    </p>
                </div>
            </div>
            
            <div id="tasks" class="content-section">
                <div class="header">
                    <i class="fas fa-arrow-left back-btn" onclick="showSection('home')"></i>
                    <h2><i class="fas fa-tasks"></i> Available Tasks</h2>
                </div>
                
                <script type="text/javascript">
                    atOptions = {
                        'key' : '46272549345a79336d26e76ff1c1d24b',
                        'format' : 'iframe',
                        'height' : 250,
                        'width' : 300,
                        'params' : {}
                    };
                </script>
                <script type="text/javascript" src="//viaanswerwillow.com/46272549345a79336d26e76ff1c1d24b/invoke.js"></script>
                
                <div class="list-item lottery-item" onclick="showSection('lottery-page')">
                    <i class="fas fa-ticket-alt task-icon"></i>
                    <div class="task-info">
                        <h4>লটারি খেলুন</h4>
                        <p>10 টাকা দিয়ে লটারি জিতলে 1000 টাকা জেতার সুযোগ আছে</p>
                    </div>
                </div>

                <div class="task-list-item" onclick="showAd()">
                    <i class="fas fa-ad task-icon ad-icon"></i>
                    <div class="task-info">
                        <h4>Watch Ads</h4>
                        <p>Watch short video ads to earn <span id="adTaskRate">50</span> BDT per view.</p>
                    </div>
                    <button class="task-button button" style="background: none; border: 1px solid var(--accent-color); color: var(--accent-color); box-shadow: none;" onclick="event.stopPropagation(); showAd();">
                        <i class="fas fa-play"></i> Watch
                    </button>
                </div>
                
                <div class="task-list-item" onclick="showSurvey()">
                    <i class="fas fa-poll-h task-icon survey-icon"></i>
                    <div class="task-info">
                        <h4>Complete a Survey</h4>
                        <p>Share your opinion and earn money.</p>
                    </div>
                    <button class="task-button button" style="background: none; border: 1px solid var(--accent-color); color: var(--accent-color); box-shadow: none;" onclick="event.stopPropagation(); showSurvey();">
                        <i class="fas fa-check"></i> Start
                    </button>
                </div>
                
                <div class="task-list-item" onclick="showVisitWebsite()">
                    <i class="fas fa-globe task-icon website-icon"></i>
                    <div class="task-info">
                        <h4>Visit a Website</h4>
                        <p>Visit our partner websites and get rewarded.</p>
                    </div>
                    <button class="task-button button" style="background: none; border: 1px solid var(--accent-color); color: var(--accent-color); box-shadow: none;" onclick="event.stopPropagation(); showVisitWebsite();">
                        <i class="fas fa-eye"></i> Visit
                    </button>
                </div>

            </div>

            <div id="extra-earning" class="content-section">
                <div class="header">
                    <h2><i class="fas fa-money-bill-wave"></i> Extra Earnings</h2>
                </div>

                <div class="card" style="margin-bottom: 25px;">
                    <div class="alert-box info" style="margin-top: 0; margin-bottom: 0;">
                        <h4><i class="fas fa-info-circle"></i> গুরুত্বপূর্ণ টিপস</h4>
                        <p>লিংকে ক্লিক করার পর **২৫ থেকে ৩০** সেকেন্ড পর্যন্ত থাকতে হবে**, না হলে টাকা পাবেন না।</p>
                    </div>
                    
                    <h3 style="margin-top: 25px; margin-bottom: 15px;">Direct Links & Social Media</h3>
                    
                    <div class="task-list-item direct-link-item" onclick="openDirectLink('https://viaanswerwillow.com/t3bkq4m9?key=bb27f4710fce3e51c5aac3d74300e08d')">
                        <i class="fas fa-link task-icon"></i>
                        <div class="task-info">
                            <h4>Direct Link 1</h4>
                            <p>এই লিংকে ভিজিট করে টাকা উপার্জন করুন।</p>
                        </div>
                        <button class="task-button button" style="background: none; border: 1px solid var(--accent-color); color: var(--accent-color); box-shadow: none;" onclick="event.stopPropagation(); openDirectLink('https://viaanswerwillow.com/t3bkq4m9?key=bb27f4710fce3e51c5aac3d74300e08d')">
                            <i class="fas fa-arrow-up-right-from-square"></i> Visit
                        </button>
                    </div>
                    
                    <div class="task-list-item direct-link-item" onclick="openDirectLink('https://viaanswerwillow.com/ygn0wmes?key=f45a5547630f1dca85f2131159f0a734')">
                        <i class="fas fa-link task-icon"></i>
                        <div class="task-info">
                            <h4>Direct Link 2</h4>
                            <p>এই লিংকে ভিজিট করে টাকা উপার্জন করুন।</p>
                        </div>
                        <button class="task-button button" style="background: none; border: 1px solid var(--accent-color); color: var(--accent-color); box-shadow: none;" onclick="event.stopPropagation(); openDirectLink('https://viaanswerwillow.com/ygn0wmes?key=f45a5547630f1dca85f2131159f0a734')">
                            <i class="fas fa-arrow-up-right-from-square"></i> Visit
                        </button>
                    </div>
                    
                    <div class="task-list-item direct-link-item" onclick="openDirectLink('https://viaanswerwillow.com/m34egi0e?key=13a8f248470c305bcf00ab953923588d')">
                        <i class="fas fa-link task-icon"></i>
                        <div class="task-info">
                            <h4>Direct Link 3</h4>
                            <p>এই লিংকে ভিজিট করে টাকা উপার্জন করুন।</p>
                        </div>
                        <button class="task-button button" style="background: none; border: 1px solid var(--accent-color); color: var(--accent-color); box-shadow: none;" onclick="event.stopPropagation(); openDirectLink('https://viaanswerwillow.com/m34egi0e?key=13a8f248470c305bcf00ab953923588d')">
                            <i class="fas fa-arrow-up-right-from-square"></i> Visit
                        </button>
                    </div>
                
                    <div class="task-list-item" onclick="openFacebook()">
                        <i class="fab fa-facebook-f task-icon facebook-icon"></i>
                        <div class="task-info">
                            <h4>Follow us on Facebook</h4>
                            <p>Follow our official Facebook page to earn.</p>
                        </div>
                        <button class="task-button button" style="background: none; border: 1px solid var(--accent-color); color: var(--accent-color); box-shadow: none;" onclick="event.stopPropagation(); openFacebook();">
                            <i class="fas fa-link"></i> Open
                        </button>
                    </div>
    
                    <div class="task-list-item" onclick="openInstagram()">
                        <i class="fab fa-instagram task-icon instagram-icon"></i>
                        <div class="task-info">
                            <h4>Follow us on Instagram</h4>
                            <p>Follow our official Instagram profile to earn.</p>
                        </div>
                        <button class="task-button button" style="background: none; border: 1px solid var(--accent-color); color: var(--accent-color); box-shadow: none;" onclick="event.stopPropagation(); openInstagram();">
                            <i class="fas fa-link"></i> Open
                        </button>
                    </div>
                </div>
            </div>
            
            <div id="referral" class="content-section">
                <div class="header">
                    <h2><i class="fas fa-users"></i> Referral Program</h2>
                </div>
                
                <div class="card balance-card">
                    <div class="balance-info">
                        <p class="balance-text">Total Referrals</p>
                        <h1 class="balance-value" id="totalReferrals">0</h1>
                    </div>
                    <i class="fas fa-user-plus balance-icon"></i>
                </div>
                
                <p style="margin-top: -15px; color:var(--secondary-text-color);">
                    Earn 100 BDT for each friend who joins using your link!
                </p>
                
                <div class="list-item">
                    <div class="task-info">
                        <h4>Your Referral Link</h4>
                        <p id="referralLink">https://your-mini-app-url.vercel.app/?ref=USER_ID</p>
                    </div>
                    <button class="task-button button secondary" style="background: var(--gradient-1); box-shadow: none;" onclick="copyLink()">
                        <i class="fas fa-copy"></i> Copy
                    </button>
                </div>
                
                <div class="alert-box info" style="margin-top: 20px;">
                    <h4><i class="fas fa-lightbulb"></i> Pro Tip</h4>
                    <p>
                        Share your referral link on social media to earn more! The more friends join, the more you earn.
                    </p>
                </div>
            </div>

            <div id="settings" class="content-section">
                <div class="header">
                    <h2><i class="fas fa-cog"></i> Settings</h2>
                </div>
                
                <div class="settings-list">
                    <div class="list-item mail-item" onclick="showSection('mail-page')">
                        <i class="fas fa-envelope"></i>
                        <h4>ইনবক্স</h4>
                    </div>
                    
                    <div class="list-item" onclick="showSection('profile-page')">
                        <i class="fas fa-user"></i>
                        <h4>Profile</h4>
                    </div>
                    
                    <div class="list-item" onclick="showSection('withdraw-page')">
                        <i class="fas fa-wallet"></i>
                        <h4>Withdraw</h4>
                    </div>
                    
                    <div class="list-item" onclick="showSection('history-page')">
                        <i class="fas fa-history"></i>
                        <h4>Withdrawal History</h4>
                    </div>
                    
                    <div class="list-item" onclick="showSection('earnings-history-page')">
                        <i class="fas fa-chart-line"></i>
                        <h4>Earnings Report</h4>
                    </div>
                    
                    <div class="list-item" onclick="showSection('change-password-page')">
                        <i class="fas fa-lock"></i>
                        <h4>Change Password</h4>
                    </button>
                    
                    <div class="list-item" onclick="showSection('privacy-policy-page')">
                        <i class="fas fa-shield-alt"></i>
                        <h4>Privacy Policy</h4>
                    </div>
                </div>
            </div>

            <div id="profile-page" class="content-section">
                <div class="header">
                    <i class="fas fa-arrow-left back-btn" onclick="showSection('settings')"></i>
                    <h2>Your Profile</h2>
                </div>
                
                <div class="card">
                    <div class="profile-info-item">
                        <label><i class="fas fa-user-tag"></i> Username</label>
                        <span id="profileUsername"></span>
                    </div>
                    
                    <div class="profile-info-item">
                        <label><i class="fas fa-signature"></i> Nickname</label>
                        <span id="profileNickname"></span>
                    </div>
                    
                    <div class="profile-info-item">
                        <label><i class="fas fa-phone"></i> Phone Number</label>
                        <span id="profilePhoneNumber"></span>
                    </div>
                </div>
                
                <button class="button secondary" onclick="showSection('settings')">
                    <i class="fas fa-arrow-left"></i> Back to Settings
                </button>
            </div>

            <div id="withdraw-page" class="content-section">
                <div class="header">
                    <i class="fas fa-arrow-left back-btn" onclick="showSection('settings')"></i>
                    <h2><i class="fas fa-money-bill-wave"></i> Withdraw Funds</h2>
                </div>
                
                <div class="card">
                    <div class="input-group">
                        <label for="amount"><i class="fas fa-coins"></i> Amount (BDT)</label>
                        <input type="number" id="amount" placeholder="Minimum 500 BDT">
                    </div>
                    
                    <div class="input-group">
                        <label for="method"><i class="fas fa-money-check-alt"></i> Payment Method</label>
                        <select id="method">
                            <option value="bkash">bKash</option>
                            <option value="binance">Binance</option>
                        </select>
                    </div>
                    
                    <div class="input-group">
                        <label for="account"><i class="fas fa-id-card"></i> Account Number/ID</label>
                        <input type="text" id="account" placeholder="Your bKash/Binance details">
                    </div>
                    
                    <div class="input-group">
                        <label for="transaction-password"><i class="fas fa-lock"></i> Transaction Password</label>
                        <input type="password" id="transaction-password" placeholder="6-digit password">
                    </div>
                </div>
                
                <button class="button" onclick="requestWithdraw()">
                    <i class="fas fa-paper-plane"></i> Request Withdrawal
                </button>
                
                <div class="alert-box info" style="margin-top: 20px;">
                    <h4><i class="fas fa-info-circle"></i> Important</h4>
                    <p>
                        Withdrawal requests are processed within 24 hours. Minimum withdrawal amount is 500 BDT.
                    </p>
                </div>
            </div>

            <div id="history-page" class="content-section">
                <div class="header">
                    <i class="fas fa-arrow-left back-btn" onclick="showSection('settings')"></i>
                    <h2><i class="fas fa-receipt"></i> Withdrawal History</h2>
                </div>
                
                <p style="color: var(--secondary-text-color); text-align: center; margin-top: 30px;">
                    <i class="fas fa-history" style="font-size: 2em; opacity: 0.5;"></i><br>
                    No withdrawal history available yet.
                </p>
                
                <button class="button secondary" onclick="showSection('settings')" style="margin-top: 30px;">
                    <i class="fas fa-arrow-left"></i> Back to Settings
                </button>
            </div>

            <div id="earnings-history-page" class="content-section">
                <div class="header">
                    <i class="fas fa-arrow-left back-btn" onclick="showSection('settings')"></i>
                    <h2><i class="fas fa-chart-line"></i> Earnings Report</h2>
                </div>
                
                <div class="card">
                    <ul class="earnings-history-list" style="list-style: none; padding: 0;">
                        <li>
                            <span class="earning-item">Total Ads Watched:</span>
                            <span class="earning-value" id="adsWatchedCount">0</span>
                        </li>
                        <li>
                            <span class="earning-item">Total Surveys Completed:</span>
                            <span class="earning-value" id="surveysCompletedCount">0</span>
                        </li>
                        <li>
                            <span class="earning-item">Total Websites Visited:</span>
                            <span class="earning-value" id="websitesVisitedCount">0</span>
                        </li>
                        <li>
                            <span class="earning-item">Total Social Tasks:</span>
                            <span class="earning-value" id="socialTasksCount">0</span>
                        </li>
                        <li>
                            <span class="earning-item">Total Task Earnings:</span>
                            <span class="earning-value" id="taskEarnings">0 BDT</span>
                        </li>
                        <li>
                            <span class="earning-item">Referral Earnings:</span>
                            <span class="earning-value" id="referralEarnings">0 BDT</span>
                        </li>
                        <li>
                            <span class="earning-item">Total Withdrawn:</span>
                            <span class="earning-value" id="totalWithdrawn">0 BDT</span>
                        </li>
                    </ul>
                </div>
                
                <button class="button secondary" onclick="showSection('settings')" style="margin-top: 20px;">
                    <i class="fas fa-arrow-left"></i> Back to Settings
                </button>
            </div>
            
            <div id="change-password-page" class="content-section">
                <div class="header">
                    <i class="fas fa-arrow-left back-btn" onclick="showSection('settings')"></i>
                    <h2><i class="fas fa-key"></i> Change Password</h2>
                </div>
                
                <div class="card">
                    <div class="input-group">
                        <label for="old-password"><i class="fas fa-lock"></i> Current Password</label>
                        <input type="password" id="old-password" placeholder="Enter current password">
                    </div>
                    
                    <div class="input-group">
                        <label for="new-password"><i class="fas fa-key"></i> New Password</label>
                        <input type="password" id="new-password" placeholder="6-digit new password">
                    </div>
                    
                    <div class="input-group">
                        <label for="confirm-password"><i class="fas fa-check-circle"></i> Confirm Password</label>
                        <input type="password" id="confirm-password" placeholder="Confirm new password">
                    </div>
                </div>
                
                <button class="button" onclick="changeTransactionPassword()">
                    <i class="fas fa-save"></i> Update Password
                </button>

                <div class="alert-box info" style="margin-top: 20px;">
                    <h4><i class="fas fa-exclamation-triangle"></i> Security Tip</h4>
                    <p>
                        Never share your password with anyone. Our team will never ask for your password.
                    </p>
                </div>
            </div>

            <div id="privacy-policy-page" class="content-section">
                <div class="header">
                    <i class="fas fa-arrow-left back-btn" onclick="showSection('settings')"></i>
                    <h2><i class="fas fa-shield-alt"></i> Privacy Policy</h2>
                </div>
                
                <div class="card">
                    <h3 style="color: var(--accent-color); margin-bottom: 15px;">
                        <i class="fas fa-lock"></i> Your Privacy Matters
                    </h3>
                    
                    <p style="color: var(--secondary-text-color); margin-bottom: 20px;">
                        We are committed to protecting your personal information. This policy explains what data we collect and how we use it.
                    </p>
                    
                    <h4 style="color: var(--text-color); margin-top: 20px; margin-bottom: 10px;">
                        <i class="fas fa-clipboard-list"></i> What We Collect
                    </h4>
                    <p style="color: var(--secondary-text-color);">
                        We collect information you provide directly, such as your username, nickname, and phone number when you register. This data is stored locally on your device to manage your profile and balance.
                    </p>
                    
                    <h4 style="color: var(--text-color); margin-top: 20px; margin-bottom: 10px;">
                        <i class="fas fa-cogs"></i> How We Use Your Data
                    </h4>
                    <p style="color: var(--secondary-text-color);">
                        - To manage your account and track your earnings<br>
                        - To process your withdrawal requests<br>
                        - To communicate with you regarding your account and tasks
                    </p>
                    
                    <h4 style="color: var(--text-color); margin-top: 20px; margin-bottom: 10px;">
                        <i class="fas fa-user-shield"></i> Data Security
                    </h4>
                    <p style="color: var(--secondary-text-color);">
                        We take reasonable precautions to protect your data. However, as this is a client-side application, please be aware that the security is limited to your device.
                    </p>
                    
                    <p style="color: var(--secondary-text-color); margin-top: 20px; font-size: 0.9em;">
                        <i class="fas fa-info-circle"></i> Last updated: August 2023
                    </p>
                </div>
                
                <button class="button secondary" onclick="showSection('settings')" style="margin-top: 20px;">
                    <i class="fas fa-arrow-left"></i> Back to Settings
                </button>
            </div>
        </div>

        <div class="nav-bar">
            <a class="nav-item active" onclick="showSection('home', this)">
                <i class="fas fa-home"></i>
                <span>Home</span>
            </a>
            <a class="nav-item" onclick="showSection('tasks', this)">
                <i class="fas fa-tasks"></i>
                <span>Tasks</span>
            </a>
            <a class="nav-item" onclick="showSection('extra-earning', this)">
                <i class="fas fa-coins"></i>
                <span>Extra</span>
            </a>
            <a class="nav-item" onclick="showSection('referral', this)">
                <i class="fas fa-users"></i>
                <span>Referral</span>
            </a>
            <a class="nav-item" onclick="showSection('settings', this)">
                <i class="fas fa-cog"></i>
                <span>Settings</span>
            </a>
        </div>
    </div>
    
    <script type='text/javascript' src='//viaanswerwillow.com/b5/7a/b6/b57ab6e3bce6c75b05b2019b75463542.js'></script>
    
    <script type="module">
        // Firebase Configuration (Replace with your actual config)
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.0.0/firebase-app.js";
        import { getFirestore, doc, setDoc, addDoc, collection, getDoc, updateDoc } from "https://www.gstatic.com/firebasejs/9.0.0/firebase-firestore.js";
        
        const firebaseConfig = {
          apiKey: "AIzaSyBaHJbFUUosjXBVG9y-kzC-jGG-66HK-6c",
          authDomain: "ensen-mining-bd.firebaseapp.com",
          projectId: "ensen-mining-bd",
          storageBucket: "ensen-mining-bd.firebasestorage.app",
          messagingSenderId: "797303836556",
          appId: "1:797303836556:web:6174cda3444978506a50a9",
          measurementId: "G-3T4103BBJH"
        };
        
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        // Constants
        const AD_RATE = 50;
        const SURVEY_RATE = 20;
        const WEBSITE_RATE = 10;
        const DIRECT_LINK_RATE = 10;
        const FACEBOOK_RATE = 5;
        const INSTAGRAM_RATE = 5;
        const DAILY_CHECKIN_BDT = 50;
        const REFERRAL_BONUS = 100;
        const DAILY_CHECKIN_CODE = "TELEGRAM_CODE123";
        const MIN_WITHDRAWAL = 500;
        
        const AD_URL = 'https://viaanswerwillow.com/zcj9ncamas?key=6836bdc985e54703a11582786d62f2a5';
        
        let currentUser = null; // To store the logged-in user's data
        let previousWinnerNumber = "-------";

        document.addEventListener('DOMContentLoaded', function() {
            // Check for a logged-in user on page load
            const loggedInUser = localStorage.getItem('loggedInUser');
            if (loggedInUser) {
                checkUserStatusAndLoadApp(loggedInUser);
            } else {
                document.getElementById('registration-screen').style.display = 'flex';
            }
        });

        // New function to check if user is active and load data
        async function checkUserStatusAndLoadApp(username) {
            const userRef = doc(db, "users", username);
            const userSnap = await getDoc(userRef);

            if (userSnap.exists()) {
                currentUser = userSnap.data();
                if (currentUser.isActive) {
                    document.getElementById('main-app').style.display = 'block';
                    document.getElementById('registration-screen').style.display = 'none';
                    document.getElementById('activation-screen').style.display = 'none';
                    localStorage.setItem('loggedInUser', username); // Save to local storage for future visits
                    updateUI(currentUser);
                    showAlert("Logged in successfully.", 'success');
                } else {
                    showAlert("Your account is not active. Please wait for the admin to approve your request.", 'error');
                    document.getElementById('activation-screen').style.display = 'flex';
                    document.getElementById('registration-screen').style.display = 'none';
                }
            } else {
                 showAlert("Username not found. Please register.", 'error');
                 document.getElementById('registration-screen').style.display = 'flex';
            }
        }
        
        // Updated showActivationForm function
        async function showActivationForm() {
            const regUsername = document.getElementById('reg-username').value.trim();
            const regNickname = document.getElementById('reg-nickname').value.trim();
            const regPhone = document.getElementById('reg-phone').value.trim();
            const regPassword = document.getElementById('reg-password').value.trim();

            if (!regUsername || !regNickname || !regPhone || !regPassword) {
                showAlert("Please fill in all the details.", "error");
                return;
            }

            // Save user data to Firebase with isActive: false
            const userRef = doc(db, "users", regUsername);
            await setDoc(userRef, {
                username: regUsername,
                nickname: regNickname,
                phoneNumber: regPhone,
                transactionPassword: regPassword,
                balance: 0,
                totalReferrals: 0,
                adsWatched: 0,
                surveysCompleted: 0,
                websitesVisited: 0,
                directLinksVisited: 0,
                socialTasks: 0,
                taskEarnings: 0,
                referralEarnings: 0,
                totalWithdrawn: 0,
                dailyCheckinDone: false,
                lotteryTickets: [],
                isActive: false // User is not active yet
            });
            
            document.getElementById('registration-screen').style.display = 'none';
            document.getElementById('activation-screen').style.display = 'flex';
        }

        // Updated submitActivation function
        async function submitActivation() {
            const transactionId = document.getElementById('transaction-id').value.trim();
            const senderNumber = document.getElementById('sender-number').value.trim();
            
            if (!transactionId || !senderNumber) {
                showAlert("Please enter both Transaction ID and your phone number.", "error");
                return;
            }

            const username = document.getElementById('reg-username').value.trim();
            
            // Send activation request to Firebase
            await addDoc(collection(db, "activation_requests"), {
                username: username,
                phoneNumber: senderNumber,
                transactionId: transactionId,
                status: 'pending'
            });

            showAlert("Your request has been submitted. Please wait for activation.", 'success');
            // Hide everything and show a "waiting" message or screen
            document.getElementById('activation-screen').style.display = 'none';
            
            // You might want to show a simple "Waiting for approval" page
            document.body.innerHTML = `<div class="container" style="display: flex; flex-direction: column; justify-content: center; height: 100vh; text-align: center;">
            <i class="fas fa-hourglass-half" style="font-size: 5em; color: var(--info-color); margin-bottom: 20px;"></i>
            <h2>Request Submitted</h2>
            <p style="color: var(--secondary-text-color);">Your activation request is pending admin approval. You will be able to log in once your account is activated.</p>
            <p style="color: var(--secondary-text-color);">Thank you for your patience!</p>
            </div>`;
        }

        function updateUI(data) {
            document.getElementById('welcome-nickname').textContent = data.nickname;
            document.getElementById('balanceDisplay').textContent = data.balance.toLocaleString() + ' BDT';
            
            document.getElementById('adTaskRate').textContent = AD_RATE;
            
            document.getElementById('profileUsername').textContent = data.username;
            document.getElementById('profileNickname').textContent = data.nickname;
            document.getElementById('profilePhoneNumber').textContent = data.phoneNumber;
            document.getElementById('totalReferrals').textContent = data.totalReferrals;
            
            document.getElementById('adsWatchedCount').textContent = data.adsWatched;
            document.getElementById('surveysCompletedCount').textContent = data.surveysCompleted;
            document.getElementById('websitesVisitedCount').textContent = data.websitesVisited;
            document.getElementById('socialTasksCount').textContent = data.socialTasks;
            document.getElementById('taskEarnings').textContent = (data.taskEarnings + data.directLinksVisited * DIRECT_LINK_RATE).toLocaleString() + ' BDT';
            document.getElementById('referralEarnings').textContent = data.referralEarnings.toLocaleString() + ' BDT';
            document.getElementById('totalWithdrawn').textContent = data.totalWithdrawn.toLocaleString() + ' BDT';

            updateReferralLink(data.username);
            updateLotteryUI();
            loadMessages();
            checkDailyCheckinStatus();
        }

        function updateLotteryUI() {
            const previousWinnerNumberElement = document.getElementById('previousWinnerNumber');
            if (previousWinnerNumberElement) {
                previousWinnerNumberElement.textContent = previousWinnerNumber;
            }

            const userTicketsList = document.getElementById('userTicketsList');
            if (userTicketsList) {
                userTicketsList.innerHTML = '';
                if (currentUser.lotteryTickets.length > 0) {
                    currentUser.lotteryTickets.forEach(ticket => {
                        const li = document.createElement('li');
                        li.textContent = `টিকিট নম্বর: ${ticket}`;
                        li.style.color = 'var(--text-color)';
                        li.style.marginBottom = '8px';
                        li.style.fontWeight = 'bold';
                        userTicketsList.appendChild(li);
                    });
                } else {
                    userTicketsList.innerHTML = `<li style="color: var(--secondary-text-color);">আপনার কেনা টিকিট এখানে দেখা যাবে।</li>`;
                }
            }
        }

        const allMessages = [
            { id: 1, title: "নতুন আপডেট!", body: "প্রিয় ইউজার, আমাদের অ্যাপে কিছু নতুন ফিচার যুক্ত করা হয়েছে।" },
            { id: 2, title: "আপনার উইথড্রয়াল রিকোয়েস্ট", body: "আপনার উইথড্রয়াল রিকোয়েস্ট সফলভাবে প্রসেস করা হয়েছে।" },
            { id: 3, title: "গুরুত্বপূর্ণ ঘোষণা", body: "অনুগ্রহ করে আপনার ট্রানজেকশন পাসওয়ার্ডটি কারো সাথে শেয়ার করবেন না।" },
        ];

        function loadMessages() {
            const mailList = document.getElementById('mailList');
            if (!mailList) return;

            mailList.innerHTML = '';
            allMessages.forEach(msg => {
                const li = document.createElement('li');
                li.className = 'mail-item';
                li.innerHTML = `
                    <h4>${msg.title}</h4>
                    <p>${msg.body}</p>
                `;
                mailList.appendChild(li);
            });
        }

        function updateReferralLink(username) {
            const currentUrl = window.location.href.split('?')[0];
            document.getElementById('referralLink').textContent = `${currentUrl}?ref=${username}`;
        }
        
        function showAlert(message, type = 'error') {
            alert(message);
        }

        function showSection(sectionId, element) {
            document.querySelectorAll('.content-section').forEach(section => {
                section.classList.remove('active');
            });
            document.getElementById(sectionId).classList.add('active');
            
            document.querySelectorAll('.nav-item').forEach(nav => {
                nav.classList.remove('active');
            });
            
            if (element) {
                element.classList.add('active');
            } else {
                const navItems = document.querySelectorAll('.nav-item');
                navItems.forEach(item => {
                    if (item.getAttribute('onclick')?.includes(sectionId)) {
                        item.classList.add('active');
                    }
                });
            }
            if (sectionId === 'lottery-page') {
                updateLotteryUI();
            }
            if (sectionId === 'mail-page') {
                loadMessages();
            }
        }

        function checkDailyCheckinStatus() {
            const dailyCheckinButton = document.getElementById('dailyCheckinButton');
            if (currentUser && currentUser.dailyCheckinDone) {
                dailyCheckinButton.style.display = 'none';
            } else {
                dailyCheckinButton.style.display = 'block';
            }
        }

        async function dailyCheckin() {
            const userCode = prompt("Please enter the daily check-in code from our Telegram channel:");
            
            if (userCode === DAILY_CHECKIN_CODE) {
                if (currentUser.dailyCheckinDone) {
                    showAlert("You have already checked in today.", 'info');
                    return;
                }
                
                currentUser.balance += DAILY_CHECKIN_BDT;
                currentUser.taskEarnings += DAILY_CHECKIN_BDT;
                currentUser.dailyCheckinDone = true;
                
                // Update Firebase
                const userRef = doc(db, "users", currentUser.username);
                await updateDoc(userRef, {
                    balance: currentUser.balance,
                    taskEarnings: currentUser.taskEarnings,
                    dailyCheckinDone: currentUser.dailyCheckinDone
                });
                
                updateUI(currentUser);
                
                showAlert(`You have received ${DAILY_CHECKIN_BDT} BDT for Daily Check-in!`, 'success');
                
                document.getElementById('dailyCheckinButton').style.display = 'none';
                
            } else if (userCode) {
                showAlert("Invalid code. Please check our Telegram channel for the correct code.", "error");
            }
        }

        function showAd() {
            showAlert("অ্যাড দেখার পর ২০ থেকে ৩০ সেকেন্ড অপেক্ষা করুন, না হলে টাকা পাবেন না।");
            window.open(AD_URL, '_blank');
            setTimeout(() => {
                completeTask('ads');
            }, 30000);
        }

        function showSurvey() {
            showAlert("Starting a dummy survey. In a real app, this would redirect you to a survey provider.", "info");
            setTimeout(() => {
                completeTask('survey');
            }, 2000);
        }

        function showVisitWebsite() {
            showAlert("ওয়েবসাইটে যাওয়ার পর ২০-৩০ সেকেন্ড থাকতে হবে, না হলে টাকা পাবেন না।");
            window.open('https://viaanswerwillow.com/eeyrjadvd?key=b26bfb80e16de3decb5fd354b8d9e82e', '_blank');
            setTimeout(() => {
                completeTask('website');
            }, 5000);
        }
        
        function openDirectLink(url) {
            showAlert("লিংকে ক্লিক করার পর ২৫-৩০ সেকেন্ড থাকতে হবে, না হলে টাকা পাবেন না।");
            window.open(url, '_blank');
            setTimeout(() => {
                completeTask('direct-link');
            }, 25000);
        }

        function openFacebook() {
            window.open('https://www.facebook.com/your-page-url', '_blank');
            setTimeout(() => {
                completeTask('facebook');
            }, 2000);
        }
        
        function openInstagram() {
            window.open('https://www.instagram.com/your-profile-url', '_blank');
            setTimeout(() => {
                completeTask('instagram');
            }, 2000);
        }

        async function completeTask(taskName) {
            let bdt = 0;
            let message = "";
            
            if (taskName === 'ads') {
                bdt = AD_RATE;
                currentUser.adsWatched++;
                message = `You watched an ad and earned ${bdt} BDT.`;
            } else if (taskName === 'survey') {
                bdt = SURVEY_RATE;
                currentUser.surveysCompleted++;
                message = `You completed a survey and earned ${bdt} BDT.`;
            } else if (taskName === 'website') {
                bdt = WEBSITE_RATE;
                currentUser.websitesVisited++;
                message = `You visited a website and earned ${bdt} BDT.`;
            } else if (taskName === 'direct-link') {
                bdt = DIRECT_LINK_RATE;
                currentUser.directLinksVisited++;
                message = `You visited a direct link and earned ${bdt} BDT.`;
            } else if (taskName === 'facebook' || taskName === 'instagram') {
                bdt = FACEBOOK_RATE;
                currentUser.socialTasks++;
                message = `You completed a social task and earned ${bdt} BDT.`;
            } else {
                return;
            }
            
            currentUser.balance += bdt;
            currentUser.taskEarnings += bdt;

            const userRef = doc(db, "users", currentUser.username);
            await updateDoc(userRef, {
                balance: currentUser.balance,
                adsWatched: currentUser.adsWatched,
                surveysCompleted: currentUser.surveysCompleted,
                websitesVisited: currentUser.websitesVisited,
                directLinksVisited: currentUser.directLinksVisited,
                socialTasks: currentUser.socialTasks,
                taskEarnings: currentUser.taskEarnings
            });

            updateUI(currentUser);
            showAlert(message, 'success');
        }
        
        async function requestWithdraw() {
            const amount = parseInt(document.getElementById('amount').value);
            const method = document.getElementById('method').value;
            const account = document.getElementById('account').value.trim();
            const password = document.getElementById('transaction-password').value;

            if (!amount || !method || !account || !password) {
                showAlert("Please fill in all the details.", "error");
                return;
            }

            if (password !== currentUser.transactionPassword) {
                showAlert("Invalid transaction password.", "error");
                return;
            }

            if (amount < MIN_WITHDRAWAL) {
                showAlert(`Minimum withdrawal amount is ${MIN_WITHDRAWAL} BDT.`, "error");
                return;
            }

            if (amount > currentUser.balance) {
                showAlert("Not enough balance to withdraw.", "error");
                return;
            }

            currentUser.balance -= amount;
            currentUser.totalWithdrawn += amount;
            
            const userRef = doc(db, "users", currentUser.username);
            await updateDoc(userRef, {
                balance: currentUser.balance,
                totalWithdrawn: currentUser.totalWithdrawn
            });

            updateUI(currentUser);
            
            showAlert(`Withdrawal request for ${amount} BDT via ${method} to ${account} has been submitted. Our team will process it within 24 hours.`, 'success');
            
            document.getElementById('amount').value = '';
            document.getElementById('account').value = '';
            document.getElementById('transaction-password').value = '';
        }

        async function changeTransactionPassword() {
            const oldPassword = document.getElementById('old-password').value;
            const newPassword = document.getElementById('new-password').value;
            const confirmPassword = document.getElementById('confirm-password').value;

            if (oldPassword !== currentUser.transactionPassword) {
                showAlert("Incorrect current password.", "error");
                return;
            }

            if (newPassword !== confirmPassword) {
                showAlert("New passwords do not match.", "error");
                return;
            }

            if (newPassword.length !== 6 || isNaN(newPassword)) {
                showAlert("New password must be a 6-digit number.", "error");
                return;
            }

            currentUser.transactionPassword = newPassword;
            const userRef = doc(db, "users", currentUser.username);
            await updateDoc(userRef, {
                transactionPassword: currentUser.transactionPassword
            });

            showAlert("Transaction password changed successfully!", 'success');
            
            document.getElementById('old-password').value = '';
            document.getElementById('new-password').value = '';
            document.getElementById('confirm-password').value = '';
            
            showSection('settings');
        }

        function copyLink() {
            const referralLink = document.getElementById('referralLink').textContent;
            navigator.clipboard.writeText(referralLink)
                .then(() => showAlert('Referral link copied to clipboard!', 'success'))
                .catch(err => console.error('Failed to copy text: ', err));
        }
        
        async function buyLotteryTicket() {
            const ticketCost = 10;
            if (currentUser.balance < ticketCost) {
                showAlert("আপনার ব্যালেন্স যথেষ্ট নয়। লটারি কিনতে কমপক্ষে 10 BDT প্রয়োজন।", "error");
                return;
            }

            currentUser.balance -= ticketCost;
            const ticketNumber = generateTicketNumber();
            currentUser.lotteryTickets.push(ticketNumber);

            const userRef = doc(db, "users", currentUser.username);
            await updateDoc(userRef, {
                balance: currentUser.balance,
                lotteryTickets: currentUser.lotteryTickets
            });
            
            updateUI(currentUser);
            
            showAlert(`আপনি একটি লটারি টিকিট কিনেছেন! আপনার টিকিট নম্বর: ${ticketNumber}`, "success");
        }

        function generateTicketNumber() {
            return Math.floor(100000 + Math.random() * 900000);
        }

        previousWinnerNumber = generateTicketNumber();

    </script>
</body>
</html>
